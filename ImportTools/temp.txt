SELECT * FROM (
	SELECT S.SystemLevel, S.SystemName, CB.BodyID AS PlanetID, CB.BodyName AS PlanetName, Null AS MoonID, Null AS MoonName
	FROM Systems S
	LEFT JOIN SystemBodies SB ON S.SystemID = SB.SystemID
	LEFT JOIN CelestialBodies CB ON SB.BodyID = CB.BodyID
	WHERE CB.IsMoon = 0

	UNION

	SELECT S.SystemLevel, S.SystemName, CB.BodyID AS PlanetID, CB.BodyName AS PlanetName, CBMoon.BodyID AS MoonID, CBMoon.BodyName AS MoonName
	FROM Systems S
	LEFT JOIN SystemBodies SB ON S.SystemID = SB.SystemID
	LEFT JOIN CelestialBodies CB ON SB.BodyID = CB.BodyID
	LEFT JOIN PlanetMoons PM ON PM.PlanetID = CB.BodyID
	LEFT JOIN CelestialBodies CBMoon ON CBMoon.BodyID = PM.MoonID
	WHERE CB.IsMoon = 0
)
ORDER BY SystemLevel, SystemName, PlanetID, MoonID;